<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Release Notes for X-Cube-MCSDK</title><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:first-child { margin-top: -20px; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="mermaid"] svg, [lang="flow"] svg { max-width: 100%; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


html, body, #write { background: rgb(255, 255, 255); font-family: arial, sans-serif; font-weight: 400; }
h1, h2, h3, h4, h5, h6 { font-family: arial, sans-serif; }
html { font-family: arial, sans-serif; font-size: 14px; }
#write { max-width: 914px; }
#write > h1:first-child { margin-top: 2.75rem; }
#write > h2:first-child { margin-top: 1.75rem; }
#write > h3:first-child { margin-top: 1rem; }
#write > h4:first-child { margin-top: 0.5rem; }
h1 { font-size: 2rem; font-weight: bold; line-height: 4rem; margin: 0px 0px 1rem; padding: 20px 30px; text-align: center; color: rgb(51, 102, 255); }
h2 { font-size: 1rem; font-weight: bold; font-style: italic; margin: 3rem 0px 1rem; padding-left: 0.2rem; text-align: left; color: white; background-color: blue; }
h3 { font-size: 1rem; font-weight: bold; text-align: left; color: black; }
h3 em { color: white; background-color: blue; padding-left: 0.2rem; padding-right: 5rem; font-style: normal; }
h4 { font-size: 1rem; font-weight: bold; text-decoration: underline; text-align: left; color: black; }
h5 { font-size: 1rem; font-weight: normal; text-decoration: underline; text-align: left; color: black; }
h6 { font-size: 1rem; font-weight: normal; text-align: center; }
p { color: black; font-size: 1rem; margin: 0px 0px 1rem; }
li > p > em { font-style: normal; text-decoration: underline; }
#write > h3.md-focus::before { left: -1.875rem; top: 0.5rem; padding: 2px; }
#write > h4.md-focus::before { left: -1.875rem; top: 0.3125rem; padding: 2px; }
#write > h5.md-focus::before { left: -1.875rem; top: 0.25rem; padding: 2px; }
#write > h6.md-focus::before { left: -1.875rem; top: 0.125rem; padding: 2px; }
ul { list-style-type: square; }
a, .md-def-url { text-decoration: none; }
a:hover { text-decoration: underline; }
table { margin-bottom: 20px; }
table th, table td { padding: 8px; line-height: 1.25rem; vertical-align: top; border: 1px solid rgb(91, 155, 213); }
table thead { background-color: rgb(91, 155, 213); color: white; }
table th { font-weight: bold; }
table thead th { vertical-align: bottom; }
table caption + thead tr:first-child th, table caption + thead tr:first-child td, table colgroup + thead tr:first-child th, table colgroup + thead tr:first-child td, table thead:first-child tr:first-child th, table thead:first-child tr:first-child td { border-top: 0px; }
table tbody + tbody { border-top: 2px solid rgb(221, 221, 221); }
table tbody tr:nth-child(2n+1) { background: rgb(222, 234, 246); }
code { font-family: consolas, monospace; color: rgb(0, 112, 192); font-size: 0.9em; }
.md-fences { border: 1px solid rgb(204, 204, 204); margin: 0px 0px 20px; font-size: 1em; padding: 0.4em 1em 0.3em; }
.task-list { padding-left: 0px; }
.task-list-item { padding-left: 2.125rem; }
.task-list-item input { top: 3px; }
.task-list-item input::before { content: ""; display: inline-block; width: 1rem; height: 1rem; vertical-align: middle; text-align: center; border: 1px solid gray; background-color: rgb(253, 253, 253); margin-left: 0px; margin-top: -0.5rem; }
.task-list-item input:checked::before, .task-list-item input[checked]::before { content: "◼"; font-size: 0.8125rem; line-height: 0.9375rem; margin-top: -1rem; }
@media screen and (-webkit-min-device-pixel-ratio: 0) and (min-resolution: 0.001dpcm) {
  .task-list-item input::before { margin-top: -0.2rem; }
  .task-list-item input:checked::before, .task-list-item input[checked]::before { margin-top: -0.2rem; }
}
blockquote { margin: 0px 0px 1.11111rem; padding: 0.5rem 1.11111rem 0px 1.05556rem; border-left: 1px solid gray; }
blockquote, blockquote p { line-height: 1; color: rgb(111, 111, 111); }
#write pre.md-meta-block { min-height: 30px; background: rgb(248, 248, 248); padding: 3em 1.5em 1.5em; font-weight: 300; font-size: 1em; margin: -1.5em -1000px 2em; color: rgb(153, 153, 153); border-left: 1000px solid rgb(248, 248, 248); border-right: 1000px solid rgb(248, 248, 248); }
.MathJax_Display { font-size: 0.9em; margin-top: 0.5em; margin-bottom: 0px; }
p.mathjax-block, .mathjax-block { padding-bottom: 0px; }
.mathjax-block > .code-tooltip { bottom: 5px; box-shadow: none; }
.md-image > .md-meta { padding-left: 0.5em; padding-right: 0.5em; }
.md-image > img { margin-top: 2px; }
.md-image > .md-meta:first-of-type::before { padding-left: 4px; }
#typora-source { color: rgb(85, 85, 85); }
#md-searchpanel { border-bottom: 1px solid rgb(204, 204, 204); }
#md-searchpanel .btn { border: 1px solid rgb(204, 204, 204); }
#md-notification::before { top: 14px; }
#md-notification { background: rgb(238, 238, 238); }
.megamenu-menu-panel .btn { border: 1px solid rgb(204, 204, 204); }





 .typora-export p, .typora-export .footnote-line {white-space: normal;} 
</style>
</head>
<body class='typora-export os-windows' >
<div  id='write'  class = 'is-node'><h1><a name='header-n0' class='md-header-anchor '></a>Release Notes for X-Cube-MCSDK</h1><p><img src='./_htmresc/STlogo.png' alt='STlogo' referrerPolicy='no-referrer' /></p><h6><a name='header-n3' class='md-header-anchor '></a>Copyright © 2019 STMicroelectronics</h6><p>The STM32Cube is a STMicroelectronics original initiative to ease developers’ life by reducing development efforts, time and cost.</p><p>The STM32Cube covers STM32 portfolio.</p><p>The STM32 microcontroller offers the performance of the industry-standard Cortex®-M core running either Vector Control or either Field Oriented Control (FOC) modes, widely used in high-performance motor drive for Air Conditioning, Home Appliances, Drones, Building &amp; Industrial Automation, Medical and E-bike applications.</p><p>The <strong>STM32 Motor Control (MC) Software Development Kit (SDK)</strong> includes:</p><ul><li><strong>ST MC FOC FW</strong> library;</li><li><strong>ST MC Six-Step FW</strong> library</li><li><strong>ST MC Workbench</strong> software tool.</li></ul><p>The ST MC FOC FW library implements the FOC mode for driving both Internal and Surface Mounted Permanent Magnets Synchronous Motor (PMSM). This implementation can drive one or two motors simultaneously with the characteristics and features listed below.</p><p>The ST MC Six-Step FW library implements the Six-Step mode for driving both Internal and Surface Mounted Permanent Magnets Synchronous Motor (PMSM). This implementation can drive one motor with the characteristics and features listed below.</p><p>Please, note that some of these features are not supported on all MCUs. In other words, the possible combinations of features and MCUs are discussed below.</p><p>Click <a href='#header-n215'>here</a> to check the supported STM32 microcontrollers and <a href='#header-n392'>there</a> for the known limitations.</p><p>Please, visit us at <a href='http://www.st.com/'>http://www.st.com</a> to download latest available documents and any update.</p><p>The ST MC FOC FW library provides the following features:</p><h4><a name='header-n21' class='md-header-anchor '></a>Motor Drive</h4><ul><li><p>Driving one or two different motors simultaneously (only one for Six-Step)</p><ul><li>In dual motors configuration, any combination of the below-mentioned speed feedback, current sampling, control mode, optional algorithm are allowed</li></ul></li><li><p>Speed or Torque Control Mode:</p><ul><li>Control Mode can be switched at any time when using FOC (even when the motor is spinning) or at compilation time for the Six-Step;</li><li>Control Mode is set independently for each motor.</li></ul></li><li><p>Programmable Speed or Torque ramps:</p><ul><li>Ramp duration (FOC only);</li><li>Final target speed or torque.</li></ul></li></ul><h4><a name='header-n42' class='md-header-anchor '></a>FOC Loop</h4><ul><li><p>SVPWM generation:</p><ul><li>Configurable PWM frequency;</li><li>Centered or Edge PWM pattern type.</li></ul></li><li><p>Open or Closed Loop operation</p><ul><li>Closed loop is default;
However, it is possible to remain in open loop when needed.</li></ul></li><li><p>Flux Weakening algorithm to reach higher than rated motor speed (optional)</p></li><li><p>Feed Forward high performance current regulation algorithm (optional)</p></li><li><p>Maximum Torque Per Ampere (I-PMSM only, optional)</p></li><li><p>Rev-Up control for sensor less configuration</p></li><li><p>On-The-Fly startup
The sensor less algorithm is able to detect if the motor is already spinning before startup, thus skipping the acceleration phase if needed (useful for fan application)</p></li><li><p>Real time tuning of:</p><ul><li>PI/PID regulators;</li><li>Sensor less algorithms (Observers, Rev-up procedure);</li><li>Optional algorithms (Feed Forward, Flux Weakening, MTPA…);</li><li>Sensor less startup procedure.</li></ul></li></ul><h4><a name='header-n77' class='md-header-anchor '></a>Six-Step Loop</h4><ul><li><p>Duty Cycle generation:</p><ul><li>Configurable PWM frequency;</li><li>Centered or Edge PWM pattern type.</li></ul></li><li><p>Open or Closed Loop operation</p><ul><li>Closed loop is default;
However, it is possible to remain in open loop when needed (decided at compilation time)</li></ul></li><li><p>Startup Control for sensor less configurations</p></li><li><p>Real time tuning of PID parameters</p></li><li><p>Back-EMF detection during PWM On time capability</p></li></ul><h4><a name='header-n98' class='md-header-anchor '></a>Current Sensing</h4><ul><li>Isolated Current Sensing (ICS, FOC only);</li><li>Single Shunt resistor current sensing - common DC-link shunt resistor (ST patented);</li><li>Three Shunt resistors current sensing - resistors placed on the bottom of the three inverter legs (FOC only);</li><li>In case of dual motors drive setup, current sensing methods can differ from one motor to the other. Then, optimization is possible to share ADCs usage between motors. </li></ul><h4><a name='header-n108' class='md-header-anchor '></a>FOC Rotor Speed &amp; Position Sensing</h4><ul><li>Support for embedded Operational Amplifiers usage on STM32 microcontroller when exists;</li><li>Sensor less Back EMF State Observer coupled with a PLL for rotor speed and angle computation (estimation);</li><li>Sensor less B-EMF State Observer coupled with a CORDIC for rotor speed and angle computation (estimation);</li><li>60° or 120° displaced HALL sensors decoding (measurement);</li><li>Quadrature Encoder decoding (measurement);</li><li>Two of these above methods can be used simultaneously on any of the motors: Main and Auxiliary one.
The Main is used in the control loop, while the other is Auxiliary. Swapping Main with Auxiliary motor are allowed during spinning.</li></ul><h4><a name='header-n122' class='md-header-anchor '></a>Six-Step Rotor Speed &amp; Position Sensing</h4><ul><li>Back-EMF measurement</li></ul><h4><a name='header-n126' class='md-header-anchor '></a>Motor Brake strategies (FOC only)</h4><ul><li>Dissipative DC link brake resistor handling;</li><li>Motor phases short-circuiting (with optional hardware over-current protection disabling);</li><li>Motor phases free-wheeling.</li></ul><h4><a name='header-n134' class='md-header-anchor '></a>Usage of STM32F30x embedded analog peripherals (FOC only)</h4><ul><li><p>Support for Programmable Gain Amplifiers (PGA) usage for current sensing:</p><ul><li>three-shunts and single shunt topologies;</li><li>internal or external gain;</li></ul></li><li><p>Support for comparators usage in Over-Current Protection (OCP) mode:</p><ul><li>three-shunts and single shunt topologies;</li><li>internal or external threshold;</li></ul></li><li><p>Support for comparators usage in Over-Voltage Protection (OVP) mode:</p><ul><li>motor phases short-circuiting mode and free-wheeling mode;</li><li>internal or external threshold.</li></ul></li></ul><h4><a name='header-n157' class='md-header-anchor '></a>Usage of FOC specific STM32F30x hardware accelerations (FOC only)</h4><ul><li>ADC queue of context (ST patented architecture);</li><li>CCM (core coupled memory) RAM;</li><li>Advanced Timer structures for single shunt topology (ST patented). </li></ul><h4><a name='header-n165' class='md-header-anchor '></a>Fault Management</h4><ul><li>Over-Current;</li><li>Over-Voltage</li><li>Under-Voltage;</li><li>Over-Heating;</li><li>Speed feedback reliability error (FOC only);</li><li>FOC algorithm execution overrun.</li></ul><h4><a name='header-n179' class='md-header-anchor '></a>ST Motor Profiler software tool (delivered with ST MC Workbench tool, FOC only)</h4><ul><li>A PC software application to auto-measure electromechanical parameters of PMSM motors (STM32F30x and STM32F4xx only);</li><li>Embedded One Touch Tuning algorithm is a new algorithm that uses a single parameter to set up the speed controller according to the type of load.
Together with the ST Motor Profiler software tool, it can be enabled to achieve the setup and run unknown motor from scratch (STM32F30x and STM32F4xx only);</li><li>Measured motor parameters can be configured in the MC application, thanks to ST Motor Control Workbench.</li></ul><h4><a name='header-n187' class='md-header-anchor '></a>ST Motor Control Workbench software tool</h4><ul><li><p>Graphical User Interface (GUI) to configure a Motor Control application:</p><ul><li>Features &amp; Algorithms are configured graphically;</li><li>Boards are configured from provided ST database: Control board, Power Board, motor parameters;</li><li>Custom power board and motor can be specified;</li><li>Generates <code>.ioc</code> file to interface STM32CubeMX PC software tool.</li></ul></li><li><p>Easy parameters tuning:</p><ul><li>PMSM FOC Library;</li><li>MCU board;</li><li>Power board;</li><li>Motor.</li></ul></li></ul><h4><a name='header-n211' class='md-header-anchor '></a>STM32CubeMx</h4><p>STM32CubeMx is a PC software tool provided by ST to configure STM32 based applications. It is not part of the STM32 MC SDK delivery, but can be downloaded freely at <a href='http://www.st.com/'>http://www.st.com</a>.</p><p>It is used to generate IAR Embedded Workbench for ARM(IAR Systems AB) or μVision® IDE for Arm® (Keil® MDK) and TrueSTUDIO ready to use projects from <code>.ioc</code> files that the ST MC Workbench produces.</p><p>In the ST MC context, the STM32CubeMX might be used to customize pins implementation of the MC application as well as to configure other peripherals that are not MC specific but nonetheless needed for the MC application (e.g.GPIO pins).</p><h2><a name='header-n215' class='md-header-anchor '></a>Supported devices and boards</h2><ul><li><p><strong>Supported Devices</strong>:</p><ul><li>STM32F0xx Family:
STM32F030RC / STM32F030R8 / STM32F031C6 / STM32F051R8 / STM32F051C8 / STM32F072VB / STM32F072RB</li><li>STSPIN32 Family:
STSPIN32F0601 / STSPIN32F0602 / STSPIN32F0251 / STSPIN32F0252 / STSPIN32F0A / STSPIN32F0B</li><li>STM32F1xx Family:
STM32F103 High, Medium and Low Densities</li><li>STM32F3xx Family:
STM32F302VB / STM32F302VC / STM32F302R8 / STM32F303VB / STM32F303VC / STM32F303ZE / STM32F303VE / STM32F303RE</li><li>STM32F4xx Family: 
STM32F417IG / STM32F415ZG / STM32F407IG / STM32F446ZE / STM32F446RE / STM32F401RE</li><li>STM32F7xx Family:
STM32F746ZG / STM32F769NI</li><li>STM32L4xx Family:
STM32L452RE / STM32L476RG</li><li>STM32G0xx Family:
STM32G081</li><li>STM32G4xx Family:
STM32G431CB / STM32G431RB / STM32G474QE </li><li>STM32H7xx Family: partially supported with examples
STM32H745ZI</li></ul></li><li><p><strong>Control Boards</strong></p><ul><li><p><em>STM32F0xxFamily:</em></p><ul><li>NUCLEO-F030R8</li><li>NUCLEO-F072RB</li><li>STM32072B-EVAL</li></ul></li><li><p><em>STM32F1xx Family</em> :</p><ul><li>NUCLEO-F103RB</li><li>STM3210E-Eval</li></ul></li><li><p><em>STM32F3xx Family:</em></p><ul><li>NUCLEO-F302R8</li><li>NUCLEO-F303RE/NUCLEO-F303RB</li><li>STM32303E-EVAL</li></ul></li><li><p><em>STM32F4xx Family:</em></p><ul><li>NUCLEO-F446RE</li><li>NUCLEO-F401RE</li><li>STM3240G-EVAL</li><li>STM3241G-EVAL</li><li>STM32446E-EVAL</li><li>STEVAL-IHM039V1</li></ul></li><li><p><em>STM32F7xx Family</em>:</p><ul><li>NUCLEO-F746ZG</li><li>STM32F769I-EVAL</li></ul></li><li><p><em>STM32L4xx Family:</em></p><ul><li>NUCLEO-L452RE</li><li>NUCLEO-L476RG</li><li>STM32L476G-EVAL</li></ul></li><li><p><em>STM32G0xx Family:</em></p><ul><li>STM32G081B-EVAL</li></ul></li><li><p><em>STM32G4xx Family:</em></p><ul><li>NUCLEO-G431RB</li><li>STM32G474E-EVAL</li></ul></li><li><p><em>STM32H7xx Family:</em> (partially supported with examples)</p><ul><li>NUCLEO-H745ZI-Q</li></ul></li></ul></li><li><p><strong>Power Boards:</strong></p><ul><li>STEVAL-IHM023V3</li><li>STEVAL-IHM025V1</li><li>STEVAL-IHM028V2</li><li>STEVAL-IHM045V1</li><li>STEVAL-IPM05F</li><li>STEVAL-IPM07F</li><li>STEVAL-IPM08B</li><li>STEVAL-IPM10B</li><li>STEVAL-IPM10F</li><li>STEVAL-IPM15B</li><li>STEVAL-IPMNG3Q</li><li>STEVAL-IPMNG3S</li><li>STEVAL-IPMNG5Q</li><li>STEVAL-IPMNG8Q</li><li>STEVAL-IPMNM1N</li><li>STEVAL-IPMNM2N</li><li>STEVAL-IPMNM1S</li><li>STEVAL-CTM009V1</li><li>X-NUCLEO-IHM07M1</li><li>X-NUCLEO-IHM08M1</li><li>X-NUCLEO-IHM11M1</li><li>X-NUCLEO-IHM16M1</li></ul></li><li><p><strong>Inverter Boards</strong></p><ul><li>STEVAL-IHM034V2 (STM32F1)</li><li>STEVAL-IHM042V1</li><li>STEVAL-SPIN3201</li><li>STEVAL-SPIN3202</li><li>STEVAL-SPIN3204</li><li>X-NUCLEO-IHM16 + NUCLEO-F303RE bundle</li><li>STEVAL-ESC001V1</li><li>B-G431B-ESC1</li><li>STSPIN32F0601S1</li><li>EVSPIN32F0601S3 </li><li>EVSPIN32F0251S1 </li><li>EVSPIN32F0602S1 </li><li>STEVAL-HKI001V2</li></ul></li></ul><h2><a name='header-n392' class='md-header-anchor '></a>Known Limitations</h2><ul><li><p>The MC SDK installer, the ST Motor Profiler and the ST Motor Control Workbench software tools are running only on a PC system, and have been tested using a Windows 7 Operating System.</p></li><li><p>LCD screen on EVAL boards are not supported;</p></li><li><p>Ac6 System Workbench for STM32 (SW4STM32) toolchain is not supported;</p></li><li><p>IP initialization with LL libraries is not supported for the STM32F1 family</p></li><li><p>With Keil MDK-ARM toolchain, using an STM32F3 MCU, packs STM32F3xx_DFP version 2.0.0 and 2.0.1 are not supported by CubeMx. Version 1.4.0 of the pack is the last version known to work well.</p></li><li><p>With STM32CubeMx 4.24.0: During the generation of F303x based projects, CubeMx pops-up an error window but the generated project is actually OK. <strong>This issue is fixed on version 4.25.0 of STM32CubeMx</strong>.</p></li><li><p>With STM32CubeMx 4.26.0: Projects generated for Atollic TrueSTUDIO do not have the correct optimization level. Optimization level is set to &quot;None (-O0)&quot; although it should be &quot;Optimize for Speed (-Ofast)&quot;. This needs to be changed manually, in TrueSTUDIO, Project&#39;s Build Settings, Tool Settings, C Compiler, Optimization.</p></li><li><p>With <strong>STM32CubeMx 5.0.0</strong>: </p><ul><li>Projects generated for all supported toolchains do not have the correct optimization level if they are generated from the graphical user interface of STM32CubeMx. Projects directly generated from the Motor Control Workbench do not suffer from this issue</li><li>Motor Control Projects configurations using an STM32L4 device do not work if generated using the LL drivers. Using the HAL ones is OK.</li><li>Motor Control Projects configurations using an STM32L4 device fail to generate if ADC discontinuous mode is set while scan mode is disabled. This is typically the case for projects using ICS as the current sensing technology.</li><li>Motor Control Projects using either an STM32F4 or an STM32F7 device and created with an older version of STM32CubeMx fail to load in STM32CubeMx version 5.0.0. A workaround consists in re-generating the projects from the Workbench (using the Generate button and not the Update one). </li></ul></li><li><p>With <strong>STM32CubeMx 5.0.1</strong>:</p><ul><li>Motor Control Projects configurations using an STM32L4 with ICS as current sensing topology do not work.</li></ul></li><li><p>With <strong>STM32CubeMx 5.2.0</strong>:</p><ul><li>Configurations based on <strong>STM32G4xxx</strong> using a <strong>Single-Shunt</strong> current sensing topology and initializing the peripherals with the <strong>LL drivers</strong> cannot be generated.</li><li>Generating  <strong>ADC</strong> initialization with the <strong>LL drivers</strong> on <strong>STM32G4xxx</strong> or <strong>STM32L4xxx</strong> based configurations results in a non working code.</li><li>Generating <strong>TIM</strong>ers initializations with the <strong>LL drivers</strong> on <strong>STM32G4xxx</strong> based configurations results in a non working code.</li></ul></li></ul><h2><a name='header-n433' class='md-header-anchor '></a>Update History</h2><h3><a name='header-n434' class='md-header-anchor '></a><em>V5.4.3 / 19-Nov-2019</em></h3><h4><a name='header-n435' class='md-header-anchor '></a>Main Changes</h4><p>Version 5.4.3 is a bug fix release of X-Cube-MCSDK v5.4.2.</p><ul><li>Fixed STSPIN based 6-Step examples that failed to build due to API changes in the HAL drivers.</li><li>Fixed an issue with the Workbench that prevented the user from saving complex firmware examples. 
Complex firmware examples are Motor Control configuration examples that consist in more than an *.stmcx file. These usually are examples that add extra code to the projects generated  by the Workbench.</li><li>Fixed incorrect HSE clock setting for STM32G431CB devices. Selecting 8 MHz as the oscillator frequency in the Workbench would actually result in HSE being set to 24 MHz. This impacts the <a href='https://my.st.com/content/my_st_com/en/products/evaluation-tools/product-evaluation-tools/mcu-mpu-eval-tools/stm32-mcu-mpu-eval-tools/stm32-discovery-kits/b-g431b-esc1.html'>B-G431B-ESC1</a> board.</li><li>Fixed an issue the support of STM32CubeIDE for firmware examples.</li><li>Listed the Position Control example in workbench.</li><li>Fixed issues with accessing Position Control specific Motor Control Protocol registers.</li><li>Fixed complex examples for STM32G4 that missed the required activation of the CORDIC HW IP</li></ul><h4><a name='header-n450' class='md-header-anchor '></a>Using STM32CubeIDE with the Motor Control SDK</h4><p>It is now possible to generate Motor Control application projects for STM32CubeIDE. These projects come with two build configuration, <code>Release</code> and <code>Debug</code>. </p><p>The <code>Release</code> configuration builds the application with the highest level of optimization, geared towards speed (<code>-Ofast</code>) but does not provide any debug capability. This configuration is meant for production firmware.</p><p>The <code>Debug</code> configuration, on the contrary, will provide the highest level of debug capability (<code>-g3</code>) but no optimization (<code>-O0</code>). Unfortunately, this configuration may not work out of the box with Motor Control Application:</p><ul><li>The absence of any optimization may result in a binary that is too large to fit in the target MCU. When this occurs, the build fails at the link step;</li><li>Without any optimization, it is very likely that the application will emit a &quot;FOC duration&quot; fault immediately when the motor is started.</li></ul><p>To be able to debug the application, the <code>Debug</code>build configuration needs to be modified to add optimization. This can be done in the Project properties dialog, section C/C++ Build, selecting the <code>Debug</code> configuration and selecting <em>Optimize for Speed</em> for the MCU GCC Compiler / Optimization item.</p><h4><a name='header-n460' class='md-header-anchor '></a>Contents</h4><figure><table><thead><tr><th>Components</th><th>Version</th><th>License Terms</th><th>Release Note</th></tr></thead><tbody><tr><td><strong>Utilities/PC_Software/STMotorProfiler</strong></td><td>1.3.1</td><td><a href='http://www.st.com/SLA0047'>Binary image</a></td><td><a href='Utilities/PC_Software/STMotorProfiler/Release%20Notes%20for%20ST%20Motor%20Profiler.html'>Motor Profiler Release Note</a></td></tr><tr><td><strong>Utilities/PC_Software/STMCWB</strong></td><td>5.4.3.19514-1.0.6.template-19-11-14</td><td><a href='http://www.st.com/SLA0047'>Binary Image</a></td><td><a href='Utilities/PC_Software/STMCWB/Release%20Notes%20for%20ST%20MC%20Workbench.html'>MCWorkbench Release Note</a></td></tr><tr><td><strong>Middlewares/ST/MotorControl</strong></td><td>5.4.3</td><td><a href='http://www.st.com/SLA0044'>Ultimate Liberty</a></td><td><a href='Middlewares/ST/MotorControl/Release%20Notes%20for%20ST%20MC%20FOC%20FW.html'>MCFirmware Release Note</a></td></tr></tbody></table></figure><h4><a name='header-n482' class='md-header-anchor '></a>STM32Cube Environment</h4><ul><li>STM32CubeMX  v5.4.0</li><li>STM32Cube_FW_F0_V1.11.0</li><li>STM32Cube_FW_F1_V1.8.0</li><li>STM32Cube_FW_F3_V1.11.0</li><li>STM32Cube_FW_F4_V1.24.1</li><li>STM32Cube_FW_F7_V1.15.0</li><li>STM32Cube_FW_G0_V1.3.0</li><li>STM32Cube_FW_G4_V1.1.0</li><li>STM32Cube_FW_L4_V1.14.0</li><li>STM32Cube_FW_H7_V1.5.0</li></ul><h4><a name='header-n504' class='md-header-anchor '></a>Development Toolchains</h4><ul><li>IAR Embedded Workbench for ARM (IAR Systems AB) v7.80.4 and v8.20.2.</li><li>μVision® IDE for Arm® (Keil® MDK) v5.24.2</li><li>Atollic TrueSTUDIO for STM32 version 9.3.0</li><li>STM32CubeIDE v1.1.0</li><li>ST-LINK/V2 v4.2.0</li></ul><p>&nbsp;</p><h3><a name='header-n517' class='md-header-anchor '></a><em>V5.4.2 / 04-Nov-2019</em></h3><h4><a name='header-n518' class='md-header-anchor '></a>Main Changes</h4><ul><li><p>Added support for the following features to configurations based on <a href='https://www.st.com/en/microcontrollers-microprocessors/stm32g4-series.html'>STM32G4xx</a> devices:</p><ul><li>The embedded <a href='https://www.st.com/resource/en/application_note/dm00614795.pdf'>CORDIC math coprocessor</a>;</li><li>Insulated Current Sensing;</li><li>Dual motors drive</li></ul></li><li><p>Introduction of the Position Control feature for configurations using a Quadrature Encoder as speed and position feedback. See the section <a href='#header-n571'>Using the Position Control feature</a> below for more details.</p></li><li><p>Projects can now be generated for the <a href='https://www.st.com/en/development-tools/stm32cubeide.html'>STM32CubeIDE</a> IDE.</p></li><li><p>Added the support for Torque Ramps in the motor control protocol.</p></li><li><p>Introduced the support of STGAP1S drives family.</p></li><li><p>Enhanced existing and added new Six-Step examples. See <a href='#header-n586'>Six-Step examples</a> section below</p><ul><li>Unified the UART speed used by the Six-Step Teraterm and the Motor Control Monitor interfaces to 115200 bps.</li></ul></li><li><p>Added support for the <a href='https://www.st.com/en/motor-drivers/stspin32f0b.html'>STSPIN32F0B</a> device.</p></li><li><p>Added support for HSI on STM32G0 based Nucleo boards.</p></li><li><p>Introduced partial support for <a href='https://www.st.com/en/microcontrollers-microprocessors/stm32h7-series.html'>STM32H7xx</a> devices. So far, only an example is provided with limited configurations capabilities.</p></li><li><p>Enabling the use of the fastest available timer clock source on STM32F3 (144 MHz) and STM32G0 (128 MHz).</p></li><li><p>The following issues have been fixed:</p><ul><li>Possible destruction of IGBTs on a Motor Stop with STM32G4xx based configurations</li><li>The <code>SPEED_UNIT</code> value cannot be changed in the State Observer + PLL speed and position feedback component with the  Web variant of the SDK.</li><li>ADC not enabled in Single Shunt configuration with STM32F3 devices when ADC clock is set to 18 MHz</li><li>DAC channels 1 and 2 cannot be set independently with STM32F4 configurations. If one is used for Debug the other one cannot be used to generate a voltage reference.</li><li>Broken support of ARM compiler version 6 in Keil uVision IDE.</li><li>Wrong ADC channel selection when ICS is used.</li><li>STMCX files with space in file name right before the file extension prevent project generation</li><li>TIM3 can be selected for debug in Single Shunt configurations though it is used as auxiliary timer. This leads to non functional configurations.</li><li>Internal PGA gain parameter missing from Workbench for STM32G4xx devices.</li></ul></li></ul><h4><a name='header-n571' class='md-header-anchor '></a>Using the Position Control feature</h4><p>The position control feature can be activated on any configuration that uses an Encoder for speed and position feedback. To activate it, open the Drive Settings dialog from the main configuration panel of the workbench, and select the Position Control item from the Control mode combo box. Dual drive configurations are also supported; the position control can then be activated on any motor equipped with an Encoder.</p><p>A set of new APIs is provided to exercise the feature. Among these, the most important ones are the following:</p><ul><li><code>void MC_ProgramPositionCommandMotor*(float fTargetPosition, float fDuration)</code> to set the mechanical angle the rotor is to reach and the duration of the movement to reach it</li><li><code>float MC_GetCurrentPosition1( void )</code> to retrieve the current rotor position</li><li><code>float MC_GetTargetPosition1( void )</code> to get the target rotor position </li><li><code>float MC_GetMoveDuration1( void )</code> to get the duration of the programmed movement.</li></ul><p>The <code>MC_ProgramPositionCommandMotor*</code> functions work as the other ramp functions of the API. For a complete description of this API, refer to the reference documentation of the Motor Control SDK.</p><p>Note that when the Position Control is activated on a motor, the speed and torque control mode cannot be used.</p><p>The Position Control feature uses floating point arithmetic. It may require a lot of CPU power on STM32F0 and STM32G0 devices that do not have an FPU.</p><h4><a name='header-n586' class='md-header-anchor '></a>Six-Step examples</h4><p>The following Six-Step examples have been added:</p><ul><li><strong>P-NUCLEO-IHM003</strong> kit</li><li><strong>NUCLEO-G431RB</strong> with an <strong>IHM07M1</strong> power stage and a <strong>BullRunning BR2804-1700Kv-1</strong> motor</li><li><strong>NUCLEO-G431RB</strong> with an <strong>IHM08M1</strong> power stage and a <strong>Shinano LA052-080E3NL1</strong> motor</li><li><strong>NUCLEO-G431RB</strong> with an <strong>IHM16M1</strong> power stage and a <strong>BullRunning BR2804-1700Kv-1</strong> motor</li><li><strong>NUCLEO-F401RE</strong> with an <strong>IHM07M1</strong> power stage and a <strong>BullRunning BR2804-1700Kv-1</strong> motor</li><li><strong>STEVAL-SPIN3204</strong> with a <strong>BullRunning BR2804-1700Kv-1</strong> motor.</li><li><strong>NUCLEO-F303RE</strong> with an <strong>X-NUCLEO-IHM16M1</strong> power stage and a <strong>Gimbal GBM2804H-100T</strong> motor.</li></ul><p>Other motors than those listed above can be supported provided that Six-Step parameters are adjusted.</p><p>&nbsp;</p><h3><a name='header-n605' class='md-header-anchor '></a><em>V5.4.1 / 05-July-2019</em></h3><h4><a name='header-n606' class='md-header-anchor '></a>Main Changes</h4><ul><li><p>Added support for the following STSPIN MCUs: STSPIN32F0601 / STSPIN32F0602 / STSPIN32F0251 / STSPIN32F0252</p></li><li><p>Added support for the following STSPIN and boards:</p><ul><li>STSPIN32F0601S1</li><li>EVSPIN32F0601S3 </li><li>EVSPIN32F0251S1 </li><li>EVSPIN32F0602S1 </li></ul></li><li><p>Added support for Dual drive configurations on the <strong>STM32G4 family</strong>.</p></li><li><p>Added support for STM32G4, STM32F7, STM32F4 , STM32L4 based boards into Motor Profiler </p><ul><li>See section <a href='#header-n653'>Profiling motors with ST Motor Profiler</a> for precautions when using the Profiler</li></ul></li><li><p>The following issues have been fixed:</p><ul><li>Incorrect polarization value of phase A for 3-Shunt configurations on STM32F0 and STM32G0 MCUs.</li><li>First ADC conversion for measuring the polarization of the current measurement was wrong on STM32F1/F3/F4/F7/G4/L4 series.</li><li>Overflow in speed control if the speed unit is set to <code>_001HZ</code></li><li>ICL was not working</li><li>Motor Profiler was not working on STM32F3 and L4 in one ADC configuration</li><li>handling of the <code>PWM_FREQUENCY_SCALING</code> parameter was incorrect in some cases </li><li>ESC Example failed to build</li><li>wrong motor power computation when stopping the motor.</li><li>The divisor of the derivative coefficient of PIDs could not be set because a prototype of the function that sets it was missing in the header file.</li><li>Code completion not working well with IAR EWARM 8.40</li><li>Fixed SW Error issue with TrueSTUDIO on CCMRAM enabled families.</li></ul></li></ul><h4><a name='header-n653' class='md-header-anchor '></a>Profiling motors with ST Motor Profiler</h4><p>When using the Motor Profiler the user must make sure that the motor is fully stopped (spinning at 0 RPM) before starting it again whatever the method (by clicking on <em>Play</em>, <em>Start Profile</em>, ...).</p><p>After a  fault occurred, or before starting the motor, the low side switches are activated in order to detect if the motor is spinning.Indeed, if the motor is spinning at that time, it may decelerate abruptly which can be dangerous. <strong>Great care must be taken to tightly fasten the motor so that it does not become dangerous when accelerating or decelerating brutally</strong>. </p><h3><a name='header-n656' class='md-header-anchor '></a><em>V5.4.0 / 27-May-2019</em></h3><h4><a name='header-n657' class='md-header-anchor '></a>Main Changes</h4><ul><li><p>Added support for the <strong>STM32G4 family</strong>.</p><ul><li>This includes the capability to profile motors with <strong>NUCLEO-G431RB+IHM16M1</strong>, <strong>NUCLEO-G431RB+IHM07M1</strong> and <strong>B-G431B-ESC1</strong> setups. See section <a href='#header-n756'>Profiling motors with NUCLEO-G431RB setups</a> below for important notice about such configurations</li></ul></li><li><p>Added the capability for customers to change the <strong>speed unit</strong> used at API level. In addition to historic 01Hz, RPM and 001Hz are made available.</p></li><li><p>Added <strong>electric angle estimation compensation</strong> in the current regulation loop (for Park and inverse Park transforms).</p></li><li><p>Added examples to demonstrates <strong>Six-Step motor drive</strong>.</p></li><li><p>Added <strong>FreeRTOS</strong> support  for F1, F43, F4, F7, L4 and G4 families.</p></li><li><p>Turned most MC Library routines into <strong><code>__weak</code> functions</strong> which simplifies and secures even further the changing or replacement of parts of the code to fit users&#39; needs.</p></li><li><p>Changed the <code>Curr_Components</code> and <code>Volt_Components</code> types to improve code readability.</p></li><li><p>Improved the precision of the reconstruction of the motor speed for Hall sensor configurations.</p></li><li><p>Simplified the usage of the low level API: it is only needed to include <code>motorcontrol.h</code> to use it now.</p></li><li><p>Added examples to support the ESC-F3 and ESC-G4 boards</p></li><li><p>Enhanced the <strong>Circle Limitation</strong> algorithm  so that <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.445ex" height="2.349ex" viewBox="0 -772.3 1052.8 1011.3" role="img" focusable="false" style="vertical-align: -0.555ex;"><defs><path stroke-width="0" id="E2-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E2-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E2-MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-64" x="824" y="-213"></use></g></svg></span><script type="math/tex">V_d</script> is never 0 which prevents some uncontrollable situations.</p></li><li><p>Unidirectional Fast Com component support is reintroduced</p></li><li><p>Added support for negative amplifying network gains in Power stage - Current sensing.</p></li><li><p>Reworked the architecture of Three-Shunt and ICS PWM &amp; Current Feedback components to add flexibility to MCSDK. The Single-Shunt implementations will be reworked as well in a future release.</p></li><li><p>Support arbitrary Timer peripherals for the Virtual DAC feature.</p></li><li><p>The layout of MCSDK in the Windows 10&#39;s Start Menu has been reworked:</p><ul><li>One folder is now created for each version of MCSDK</li><li>MCSDK&#39;s Release Notes are now accessible from this folder</li><li>The Uninstall program is now accessible from this folder</li></ul></li><li><p>Support for the following boards has been added:</p><ul><li><code>STEVAL-CTM009V1</code> power board configured in ICS topology in Workbench</li><li><code>STEVAL-IPMNG3S</code> for 3Sh and 1Sh topology in Workbench</li><li><code>STEVAL-IPMNM1S</code> for 3Sh and 1Sh topology in Workbench</li><li><code>STEVAL-IPMNM2S</code> for 3Sh and 1Sh topology in Workbench</li></ul></li><li><p>The following issues have been fixed:</p><ul><li>1-Shunt configurations from running on STM32F7 devices do not work.</li><li>Impossibility to use the second DAC channel on STM32F7 devices.</li><li>Motor Control Registers cannot be read across the UART interface if their value is -1.</li><li>Wrong PWM duty cycles generation for 1-Shunt configuration on STM32G0 devices. The issue was mostly visible with low PWM frequencies or with a Repetition Counter strictly higher than 1.</li><li>Wrong computation of the power of the motor in case of negative speed for open loop configurations.</li><li>Wrong value computed for parameter C5 of the State Observer</li><li>Detection of motor stall situations in configurations using Hall sensors as speed and position feedback technique.</li><li>Typo in Break IRQ handler function with F4 3-Shunt configurations</li><li>IOC clocks frequencies definitions for G0 MCUs.</li><li>Compilation warnings on non IAR toolchain due to IAR MISRA pragmas: these warning are removed</li><li>Reuse TIMx CH4 instead of TRGO as ADC trigger within F7 project</li><li>dual ICS F4 project does not work</li><li>ICS F7 project does not compile</li><li>Memory Fault in the RCM Handle Array when Memory Protection is enabled</li><li>State machine issue with Encoder configuration</li><li>Shunt resistor(S) value can’t be set less than 1 milliohm in Workbench</li><li>Expected over-current can’t be set more than 99.99A in Workbench</li><li>Changed the Shunt Resistor minimum value to 0.0001 in Workbench</li></ul></li></ul><h4><a name='header-n751' class='md-header-anchor '></a>Speed Unit at API level</h4><p>Up to now, the speed unit used by API functions that expect or return a speed (like <code>MC_ProgramSpeedRampMotor1()</code> or <code>MC_GetMecSpeedAverageMotor1()</code> for instance) was the tenth of Hertz (01Hz). For commodity, it is now possible to use other units for these functions. With release 5.4.0, the two new speed units are made available: the RPM (Revolution Per Minute) and the 001HZ (Hundredth of Hertz).</p><p>The choice of the speed unit is made at compile time, by setting the <code>SPEED_UNIT</code> symbol to the proper value in file <code>mc_stm_types.h</code>: <code>_RPM</code> for RPM, <code>_001HZ</code> for Hundredth of Hertz and <code>_01HZ</code> for Tenth of Hertz. The <code>SPEED_UNIT</code> define is placed in a User Section so that users&#39; modification are resistant to project regeneration.</p><p>The default speed unit at API level remains the Tenth of Hertz for the time being. Refer to the reference documentation of the firmware to get a complete information on the functions that are impacted by this change.</p><p><strong><em>Note</em></strong>:  PID parameters computed by the Motor Control Workbench for speed regulation are suited for speed in 01Hz. The motor control subsystem internally scales them to adapt to the actual speed unit.</p><h4><a name='header-n756' class='md-header-anchor '></a>Profiling motors with NUCLEO-G431RB setups</h4><p>When using the Motor Profiler with configurations based on a NUCLEO-G431RB control board, the user must make sure that the motor is fully stopped (spinning at 0 RPM) before starting it again whatever the method (by clicking on <em>Play</em>, <em>Start Profile</em>, ...).</p><h4><a name='header-n758' class='md-header-anchor '></a>Electrical angle estimation compensation</h4><p>The current regulation loop of the motor control subsystem uses the rotor&#39;s electrical angle in its computation. It is needed for the Park transform that computes the <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.01ex" height="2.624ex" viewBox="0 -772.3 865.3 1129.8" role="img" focusable="false" style="vertical-align: -0.83ex;"><defs><path stroke-width="0" id="E7-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E7-MJMATHI-71" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E7-MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E7-MJMATHI-71" x="622" y="-213"></use></g></svg></span><script type="math/tex">I_q</script> and <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.113ex" height="2.349ex" viewBox="0 -772.3 909.8 1011.3" role="img" focusable="false" style="vertical-align: -0.555ex;"><defs><path stroke-width="0" id="E8-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E8-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E8-MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E8-MJMATHI-64" x="622" y="-213"></use></g></svg></span><script type="math/tex">I_d</script> current components and then in the Inverse Park that computes the <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.349ex" viewBox="0 -772.3 1135.5 1011.3" role="img" focusable="false" style="vertical-align: -0.555ex;"><defs><path stroke-width="0" id="E9-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E9-MJMATHI-3B1" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E9-MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-3B1" x="824" y="-213"></use></g></svg></span><script type="math/tex">V_\alpha</script> and <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.527ex" height="2.624ex" viewBox="0 -772.3 1088.2 1129.8" role="img" focusable="false" style="vertical-align: -0.83ex;"><defs><path stroke-width="0" id="E10-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E10-MJMATHI-3B2" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E10-MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E10-MJMATHI-3B2" x="824" y="-218"></use></g></svg></span><script type="math/tex">V_\beta</script> voltages that are passed to the SVPWM algorithm for phase voltage computation.  <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.01ex" height="2.624ex" viewBox="0 -772.3 865.3 1129.8" role="img" focusable="false" style="vertical-align: -0.83ex;"><defs><path stroke-width="0" id="E7-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E7-MJMATHI-71" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E7-MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E7-MJMATHI-71" x="622" y="-213"></use></g></svg></span><script type="math/tex">I_q</script> and <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.113ex" height="2.349ex" viewBox="0 -772.3 909.8 1011.3" role="img" focusable="false" style="vertical-align: -0.555ex;"><defs><path stroke-width="0" id="E8-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E8-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E8-MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E8-MJMATHI-64" x="622" y="-213"></use></g></svg></span><script type="math/tex">I_d</script> are related to the current PWM period while <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.349ex" viewBox="0 -772.3 1135.5 1011.3" role="img" focusable="false" style="vertical-align: -0.555ex;"><defs><path stroke-width="0" id="E9-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E9-MJMATHI-3B1" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E9-MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-3B1" x="824" y="-213"></use></g></svg></span><script type="math/tex">V_\alpha</script> and <span class="MathJax_Preview"></span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.527ex" height="2.624ex" viewBox="0 -772.3 1088.2 1129.8" role="img" focusable="false" style="vertical-align: -0.83ex;"><defs><path stroke-width="0" id="E10-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E10-MJMATHI-3B2" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E10-MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E10-MJMATHI-3B2" x="824" y="-218"></use></g></svg></span><script type="math/tex">V_\beta</script> are meant to be used in the next one. </p><p>However, the implementation provided in MCSDK uses the same electrical angle for both the Park and the inverse Park transforms. Though this is not much of a problem when the ratio between the PWM frequency and the electrical rotation speed is high, this may be a problem when this ratio gets lower. </p><p>In addition, when using sensor-less configurations, the electrical angle used in a given PWM period is computed on current and V~Bus~ measurements made during the previous one.</p><p>The Motor Control firmware now allows for using different angles for the Park and Inverse Park. This is controlled with two symbols defined in the <code>drive_parameters.h</code> file:</p><ul><li><code>PARK_ANGLE_COMPENSATION_FACTOR</code> is multiplied to the last measured instantaneous rotor speed (which is the angle variation between the last two PWM periods) and the result is added to the current angle before it is used for the Park transform.
Its default value is <strong>0</strong>.</li><li><code>REV_PARK_ANGLE_COMPENSATION_FACTOR</code> is multiplied to the last measured instantaneous rotor speed (which is the angle variation between the last two PWM periods) and the result is added to the current angle right before it is used for the inverse Park transform for reference computation.
Its default value is <strong>0</strong>.</li></ul><p>A similar set of two symbols, <code>PARK_ANGLE_COMPENSATION_FACTOR2</code> and <code>REV_PARK_ANGLE_COMPENSATION_FACTOR2</code> respectively, are defined for the second motor in dual drive configurations.</p><p>All these symbols are defined in User Sections so they can be changed without being reset if the project is regenerated.</p><h4><a name='header-n770' class='md-header-anchor '></a>6-Step Examples</h4><p>Note that the 6-Step drive implementation that is proposed in these examples is still experimental. Its integration within the Motor Control SDK is very preliminary and will change in future releases.</p><p>6 examples are provided on three different configurations:</p><ul><li><strong>P-NUCLEO-IHM003</strong> motor control kit.</li><li><strong>NUCLEO-G431RB</strong> control board + <strong>X-NUCLEO-IHM16M1</strong> power board + <strong>BullRunning BR2804-1700Kv-1</strong> motor.</li><li><strong>NUCLEO-G431RB</strong> control board + <strong>X-NUCLEO-IHM07M1</strong> power board + <strong>BullRunning BR2804-1700Kv-1</strong> motor.</li></ul><p>In its current state, the Motor Control Protocol is only partially supported by the 6-Step implementation. Alternatively, a console like, command line interface over the serial port is provided which allows for a finer control over the application.</p><p>For each of the three configurations above, two examples are delivered, one for the console interface and one with the Motor Control Protocol.</p><h5><a name='header-n782' class='md-header-anchor '></a>6-Step Example Usage</h5><p>In 6-Step configurations, the Motor Control Protocol currently suffers from the following limitations:</p><ul><li>the mechanical speed of the motor can be set  provided that it is positive, </li><li>the speed ramp mechanism is not implemented yet </li><li>the speed and application state are the only two internal variables that are monitored. Notably, the temperature, bus voltage and motor power are not measured. </li></ul><p>In addition the DAC feature is not supported yet. This status will change in future releases as the integration level of the 6-Step implementation increases. </p><p>Alternatively, the 6-Step implementation provides a command line interface over the serial port. This command line interface can be accessed with the TeraTerm terminal emulator for instance and allows for a finer control over the application.</p><p>The TeraTerm configuration to use is described in the <code>TERATERM_G431RB_230400_Pnone.ini</code> file delivered with the example. </p><p>At startup, the Application prints a banner followed by a list of possible commands as welcome message:</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  *******************</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * 6 STEP LIB *</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  *******************</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * List of commands:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;GETSPD&gt; Get Motor Speed</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;GETSTA&gt; Get Motor Status</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;SELMOT&gt; Select Motor</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;SETDIR&gt; Set Motor Direction</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;SETSPD&gt; Set Motor Speed</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;STARTM&gt; Start Motor</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * &lt;STOPMT&gt; Stop Motor</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  * </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 300px;"></div></div></div></pre><p> Then the application waits for the user to type a command and press the enter key to execute it.
Each command is 6 characters long. For commands that expect arguments, first type the name of the command, then press enter and then a prompt line invites the user to enter the value of the argument.</p><p>The list of all commands follows:</p><ul><li><code>GETSPD</code>: Returns the current mechanical speed of the current motor, in RPM.</li><li><code>GETSTA</code>: Returns the current status of the current motor. Posible status are: <code>IDLE</code>, <code>STOP</code>, <code>ALIGNMENT</code>, 
​    ​    <code>STARTUP</code>, <code>RUN</code>, <code>SPEEDFDBKERROR</code>, <code>OVERCURRENT</code>, <code>VALIDATION_FAIL</code>, <code>LF_TIMER_FAILURE</code>.</li><li>`SELMOT: Select the current motor. This command does nothing on single drive setups.</li><li><code>SETDIR</code>: Sets the direction of the motor. Accept on parameter that can be either <code>CW</code> (Clockwise) or 
​    ​    <code>CCW</code> (Counter Clockwise).</li><li><code>SETDCY</code>: Sets the PWM duty cycle. This command is used to control the motor when the speed loop is 
​    ​    not built in the application, which is the default case. This command expects one parameter:
​    ​    the value of the duty cycle in tenth of percent (in thousandths). Accepted values range from 
​    ​    0 to 1000.</li><li><code>SETSPD</code>: Sets the mechanical speed reference of the current motor. This command is active only if 
​    ​    the speed loop has been built in the application. This command expects one argument: the 
​    ​    speed in RPM.</li><li><code>STARTM</code>: Starts the current motor.</li><li><code>STOPMT</code>: Stops the current motor.</li></ul><h5><a name='header-n815' class='md-header-anchor '></a>6-Step Example Configuration</h5><p> In its current state the configuration possibilities of the application are limited.</p><p>There are two ways to configure the example. </p><ol start='' ><li><p>First, by using STM32CubeMx, to choose which 6-Step features to use: In the Pinout and 
Configuration view, peripheral pane, click on &quot;A-Z&quot; to list all peripherals and middlewares
in alphabetical order. Browse down to MotorControl and click on it. This opens a pane in the
middle, showing some configuration options. </p><ul><li><code>SIX_STEP_CONTROL_MODE</code> allows for choosing between Current and Voltage modes. </li><li><code>SIX_STEP_SPEED_LOOP</code>: if checked, a speed regulation loop is built in the application and mechanical speed reference can be set. If it is unchecked the speed is not regulated and the only way to control the motor is by setting the PWM duty cycle applied to the active phase(s). Such a control cannot be achieved with the Motor Control Monitor at the moment.</li><li><code>SIX_STEP_SET_POINT_RAMPING</code>: if checked, builds the Set Point Ramping feature in the application.</li><li><code>SIX_STEP_THREE_PWM</code>: this must be checked for power boards where the MCU drives enable signals<br/>instead of the complementary PWM channels, as it is the case for the <strong>X-NUCLEO-IHM07M1</strong> or <strong>X-NUCLEO-IHM16M1</strong> power boards and more generally with gate drivers like ST&#39;s L6230 or STSPIN830.</li></ul></li><li><p>Other parameters, like motor parameters or PID factors for instance can be changed in the <strong>USER CODE</strong> 
sections of the <code>6step_conf_*.h</code> files.</p></li></ol><h4><a name='header-n832' class='md-header-anchor '></a>Working with STM32CubeIDE for Motor Control projects</h4><p>Motor Control projects generated with STM32 Motor Control Workbench fail to build. Before a solution can be developed for this issue, a work around exists that allows to use ST&#39;s new IDE with Motor Control projects by following the procedure described in this section and by respecting a few rules.</p><ol start='' ><li>In STM32 Motor Control Workbench, when generating or updating a project, choose either <code>ST SW4 STM32</code> or <code>ST TrueSTUDIO</code> as the Target Toolchain. 
<strong>Note</strong>: STM32G4 based projects cannot be generated with <code>TrueSTUDIO</code>.</li><li>Open <code>STM32CubeIDE</code>, go to the File menu and select the &quot;Open Projects from File System...&quot; item.</li><li>In the dialog that opens, click the &quot;Directory...&quot; button on the &quot;Import source&quot; line. Navigate to the directory that contains the generated project and select it.</li><li>The Dialog should now propose two projects for import. Select only the one that has the &quot;Convert &#39;TrueSTUDIO...&quot; or &quot;Convert &#39;System Workbench...&#39;&quot; mention in the &quot;Import as column&quot;. The other one must not be selected.</li><li>the imported project should build and run as expected.</li></ol><p>It is important to follow a few rules when working with such imported projects:</p><ul><li>Do not edit the project&#39;s IOC file from the STM32CubeMx perspective embedded in STM32CubeIDE. A standalone version of STM32CubeMx should be used instead.</li><li>Do not generate the sources of the project from the STM32CubeMx perspective embedded in STM32CubeIDE. A standalone version of STM32CubeMx should be used instead.</li><li>Each time the project is (re)generated (wether from CubeMx or from MC Workbench), it needs to be imported again in STM32CubeIDE.</li></ul><h3><a name='header-n853' class='md-header-anchor '></a><em>V5.3.3 / 18-Jan-2019</em></h3><h4><a name='header-n854' class='md-header-anchor '></a>Main Changes</h4><ul><li>Fixed an issue with VBus and Temperature acquisition when performed with another ADC than the current sensing one.</li><li>Fixed an issue with the building of projects generated for devices of the STM32G0 family.</li><li>Fixed an issue that prevented the use of the DAC peripheral for some STM32F0 MCUs like the STM32F051xxx.</li><li>Fixed an issue with the configuration of the current sampling ADC on STM32F401 when building with the HAL Drivers instead of the LL ones.</li><li>Added support for  the STM32G0 family with Atollic TrueSTUDIO.</li><li>Complex firmware examples are now accessible directly from Workbench.</li><li>Added a FreeRTOS based example working on the P-NUCLEO-IHM001 motor control kit.</li></ul><p>&nbsp;</p><h3><a name='header-n871' class='md-header-anchor '></a><em>V5.3.2 / 21-Dec-2018</em></h3><h4><a name='header-n872' class='md-header-anchor '></a>Main Changes</h4><ul><li>Fixed an issue with negative speed in Open Loop mode.</li><li>Fixed an issue that prevented dual drive 1 shunt configurations to build on IHM042V1</li><li>Fixed an issue with the Potentiometer example that could not build with TrueSTUDIO.</li><li>Reintroduced some example projects that had been removed in previous version</li><li>Fixed the incorrect configuration of HSE value with STM3240G-EVAL and STM3241G-EVAL control boards when converting projects from older Workbench versions</li><li>Fixed pinning configuration issues when creating projects based on IHM042V1, NUCLEO-F302R8 + IHM08M1, F4 and some F3 boards.</li></ul><p>&nbsp;</p><h3><a name='header-n887' class='md-header-anchor '></a><em>V5.3.1 / 10-Dec-2018</em></h3><h4><a name='header-n888' class='md-header-anchor '></a>Main Changes</h4><ul><li>Added support for the STM32G0 family (See <a href='#header-n215'>Supported devices and boards</a> above). Note that this support does not include Atollic TrueSTUDIO yet.</li><li>The installer of the Motor Control SDK can now install for all users or for the current one.</li><li>Support of two different ADCs for the VBus and Temperature measurements.</li><li>The Workbench now lets the user selects the LL/HAL version to use. </li><li>Added an Example using FreeRTOS with a Motor Control Application</li><li>Added an example with a Gimbal motor and the IHM16M1 power board.</li><li>Fixed an issue in F4, 3-Shunt, 1 ADC current sensing that resulted in either an Over Current or a Speed Feedback error. </li><li>Fixed an issue that prevented dual drive configurations to work in the case where the motors had different PWM frequencies.</li><li>Fixed an issue that prevented single shunt configurations driving the low side transistors on STM32F446  to work.</li><li>Fixed FOC and SW Error issues that happened on STSPIN32F0/STM32F0 when the PWM Frequency was set above 18KHz.</li><li>Fixed the CCMRAM examples for TrueSTUDIO. </li></ul><h3><a name='header-n912' class='md-header-anchor '></a><em>V5.2.0 / 03-Aug-2018</em></h3><h4><a name='header-n913' class='md-header-anchor '></a>Main Changes</h4><ul><li>Added support for the STM32F7 family (See <a href='#header-n215'>Supported devices and boards</a> above)</li><li>Added support for the STM32L4 family (See <a href='#header-n215'>Supported devices and boards</a> above)</li><li>Added support for the STM32F401 device and the NUCLEO-F401RE board</li><li>Introduction of the Regular Conversion Manager to manage application&#39;s and motor control subsystem&#39;s ADC regular conversions </li><li>Added CCMRAM support for Atollic TrueSTUDIO toolchain in related examples</li><li>Added a HardFault Handling routine that stops PWM generation to all STM32 Families (already implemented for F3).</li><li>Display Firmware version used by ST MotorControl Workbench in &quot;About&quot; dialog of the Workbench</li><li>Fixed an issue in workbench where the list of proposed ADC channels would not match the selected ADC peripheral for STM32F4 devices.</li><li>Fixed an issue in workbench that only allowed for selecting TIM3 and TIM4 for Hall Sensors and Encoder handling for F4 Series. Now, TIM2 and TIM5 can also be selected.</li><li>Fixed an issue in the firmware that would lead to defining handle variables multiple times in 3 Shunt, shared resourced configurations.</li></ul><h4><a name='header-n935' class='md-header-anchor '></a>NUCLEO-F746ZG and IHM07M1 power board</h4><p>The DIAG/EN (over current detection) output of the L6230 driver on the IHM07M1 power board is used as Break Input of the PWM timer. This signal routed to three  pins on the C12 connector of the NUCLEO-F746ZG board. One of these pins, C12_28, leads to the PB14 pin of the MCU which also controls one of the LEDs featured on this board. </p><p>If PB14 is configured to control the LED, the Break Input gets triggered when the LED is switched resulting in false over current faults. to avoid this issue, resistor R49 needs to be removed from the IHM07M1 board or PB14 must not be configured as output.</p><p>Note that ST Motor Control Workbench configures PB14 to drive the LED.</p><h4><a name='header-n939' class='md-header-anchor '></a>Regular Conversion Manager</h4><p>The Regular Conversion Manager (RCM) is a new component that primarily aims at handling ADC regular conversions needed by the Motor Control subsystem. These are typically needed for Bus Voltage sensing and Temperature reading. </p><p>This component ensures that Motor Control subsystem&#39;s regular conversions are performed well whether these conversions are done on an ADC that is already used for Current Sensing or not and even if the target ADC does not support injected channels. This service is needed to prepare for the support of future inverter boards. </p><p>The RCM component is instantiated only once in the system.</p><p>Customers application are welcome to use this service. Refer to the Reference documentation for more information.</p><h3><a name='header-n944' class='md-header-anchor '></a><em>V5.1.3 / 10-Jul-2018</em></h3><p>Version 5.1.3 is a bug fix release of X-Cube-MCSDK v5.1.</p><h4><a name='header-n946' class='md-header-anchor '></a>Main Changes</h4><ul><li>Fixed an issue that prevented the SysTick counter from incrementing. Because of this issue, HAL_Delay() was blocking forever.</li></ul><h3><a name='header-n950' class='md-header-anchor '></a><em>V5.1.2 / 06-Jul-2018</em></h3><p>Version 5.1.2 is a bug fix release of X-Cube-MCSDK v5.1.</p><h4><a name='header-n952' class='md-header-anchor '></a>Main Changes</h4><ul><li>Added support for STM32F1 based Nucleo board</li><li>Added support for the STM32F3 based ESC inverter board (includes Motor Control Profiler)</li><li>Added support for Atollic IDE to all examples delivered with the SDK (Except CCMRAM examples).</li><li>Fixed the name of the MC library in the CCMRAM + Atollic configuration. This issue prevented from building such configurations.</li><li>Fixed an issue with the configuration of the ADC in STM32F3, Shared resources with external OpAmps cases.</li><li>Fixed an issue where Id ref would not go back to 0 when exiting the flux weakening state.</li><li>Fixed an issue with the startup procedure that was sometimes having undefined behavior on failure.</li><li>Fixed return type of <code>MC_StopMotor*()</code> function. They now return a boolean value to indicate success or failure.</li></ul><h3><a name='header-n970' class='md-header-anchor '></a><em>V5.1.1 / 07-Jun-2018</em></h3><p>Version 5.1.1 is a bug fix release of X-Cube-MCSDK v5.1.</p><h4><a name='header-n972' class='md-header-anchor '></a>Main Changes</h4><ul><li>Fixed an issue that prevented STM32CubeMx version 4.26 from generating ST Motor Control SDK projects. STM32CubeMx versions 4.25.x still work with the SDK.</li><li>Updated X-Cube-MCSDK-FUL release of the SDK with missing examples.</li><li>Fixed the handling of Low sides Idle state for all families. Setting it to a different value than that the High sides is now has the expected effect. </li><li>Fixed the handling of the High sides Polarity and Idle state for STM32F1 and STM32F4 families. Setting them to values that differ from the defaults now has the expected effect.</li></ul><h4><a name='header-n982' class='md-header-anchor '></a>Development Toolchains</h4><ul><li>IAR Embedded Workbench for ARM (IAR Systems AB) v7.80.4 and v8.20.2.</li><li>μVision® IDE for Arm® (Keil® MDK) v5.25</li><li>Atollic TrueSTUDIO for STM32 version 9.0.0</li><li>ST-LINK/V2 v4.2.0</li></ul><h3><a name='header-n992' class='md-header-anchor '></a><em>V5.1.0 / 05-Jun-2018</em> </h3><h4><a name='header-n993' class='md-header-anchor '></a>Main Changes</h4><ul><li><p>Added support for the STM32F1 High Density series (See <a href='#header-n215'>Supported devices and boards</a> below);</p></li><li><p>Added support for STEVAL-SPIN devices (See <a href='#header-n215'>Supported devices and boards</a> below);</p></li><li><p>Introduction of the Power Factor Correction feature for STM32F103 High Density MCUs;</p></li><li><p>Added support for Atollic® TrueSTUDIO® IDE on STM32F3 Family;</p></li><li><p>Added the possibility for the user to choose the version of STM32CubeMx to use;</p></li><li><p>Added support for the Start/Stop motor button;</p></li><li><p>Added support for IP initialization with LL libraries (except for STM32F1 family)</p></li><li><p>Bug fixes, among which:</p><ul><li>Complementary Dead time is not set to 0 anymore in some STM32F4 configurations</li><li>Restored support for IAR 7.x versions</li></ul></li></ul><h4><a name='header-n1016' class='md-header-anchor '></a>Complementary Dead time setting on STM32F4</h4><p>In earlier versions of ST Motor Control SDK, Motor Control configurations using an STM32F4 MCU and a power board where both the high-side and low-side transistors are driven by the MCU are faulty: The complementary dead time parameter is set to 0 which may result in destructive short-circuits on the power stage. </p><p>This issue is fixed in ST Motor Control SDK version 5.1.0. It is highly recommended to update any such STM32F4 based project to this version of the SDK.</p><p>Note that configurations using motor drivers that automatically handle this dead time (such as the L6230 featured in the X-NUCLEO-IHM07M1 power board for instance) are not impacted.</p><h4><a name='header-n1020' class='md-header-anchor '></a>Power Factor Correction</h4><p>The Power Factor Correction (PFC) feature is provided as an example running on the STEVAL-IHM034V2 inverter board. Look in the folder where the SDK is installed, in the <code>Projects\STEVAL-IHM034V2\MotorControlWithPFCExample</code> folder.</p><p>The PFC feature has been validated with an electronic load.</p><h4><a name='header-n1023' class='md-header-anchor '></a>TrueSTUDIO® IDE on STM32F3 Family support</h4><p>The support of TrueSTUDIO® requires the use of the STM32Cube MCU Package for STM32F3 Series version 1.9.1 . </p><p>Note that TrueSTUDIO® support for other STM32 families may be added with new versions of the STM32Cube MCU Packages for these families.</p><h4><a name='header-n1026' class='md-header-anchor '></a>Warnings</h4><ul><li>The start/stop motor button is not supported on STEVAL-SPIN boards;</li><li>STM32F0 based projects built with the MDK-ARM (Keil) tool chain may fail to spin the motor and show a FOC duration error. To prevent this, the PWM Frequency  parameter in Driver Management, Drive Settings, should be lowered (typically down to 10 KHz) in the ST MC Workbench.</li></ul><h4><a name='header-n1032' class='md-header-anchor '></a>Development Toolchains</h4><ul><li>IAR Embedded Workbench for ARM (IAR Systems AB) v7.80.4 and v8.20.2.</li><li>μVision® IDE for Arm® (Keil® MDK) v5.25</li><li>ST-LINK/V2 v4.2.0</li></ul><h4><a name='header-n1040' class='md-header-anchor '></a>STM32CubeMX Environment</h4><ul><li>STM32CubeMX  v4.25.1</li><li>STM32Cube_FW_F0_V1.9.0</li><li>STM32Cube_FW_F3_V1.9.0 / STM32Cube_FW_F3_V1.9.1</li><li>STM32Cube_FW_F4_V1.19.0</li></ul><h3><a name='header-n1050' class='md-header-anchor '></a><em>V5.0.3 / 17-Apr-2018</em></h3><h4><a name='header-n1051' class='md-header-anchor '></a>Main Changes</h4><ul><li>Version 5.0.3, bug fix release of X-Cube-MCSDK v5.0.</li><li>Fixed the detection of the latest STM32CubeMx versions by ST Motor Control Workbench.</li><li>Fixed Virtual Bus Voltage Sensor integration in ST Motor Control SDK.</li></ul><h4><a name='header-n1060' class='md-header-anchor '></a>Development Toolchains</h4><ul><li>IAR Embedded Workbench for ARM (IAR Systems AB) v7.80.4 and v8.20.2.</li><li>μVision® IDE for Arm® (Keil® MDK) v5.25</li><li>ST-LINK/V2 v4.2.0</li></ul><h4><a name='header-n1068' class='md-header-anchor '></a>STM32CubeMX Environment</h4><ul><li>STM32CubeMX     v4.25.0</li><li>STM32Cube_FW_F0_V1.9.0</li><li>STM32Cube_FW_F3_V1.9.0</li><li>STM32Cube_FW_F4_V1.19.0</li></ul><h3><a name='header-n1078' class='md-header-anchor '></a><em>V5.0.2 / 04-Apr-2018</em></h3><h4><a name='header-n1079' class='md-header-anchor '></a>Main Changes</h4><ul><li>Version 5.0.2, bug fix release of X-Cube-MCSDK v5.0</li><li>Support for several, parallel versions of the Motor Control SDK (See below)</li><li>Support for IAR EWARM versions 8.x</li><li>Support for μVision® IDE for Arm® (Keil® MDK) v5.24.2.0</li><li>Support for mixed 1-shunt / 3-shunt dual drive setup with STM32 F3.</li></ul><h4><a name='header-n1091' class='md-header-anchor '></a>Parallel Motor Control SDKversions support</h4><p>Several versions of the Motor Control SDK can be installed in parallel on the same PC.Version 5.0.1 of the Motor Control Workbench would install the Motor Control Firmware in the user’s STM32Cube repository in the <code>MotorControl</code> folder (typically in <code>C:\Users\&lt;username&gt;\STM32Cube\Repository\MotorControl</code>). With version 5.0.2 onwards, the firmware is installed in the <code>MCSDK_vX.Y.Z\MotorControl</code> subfolder of the user’s STM32Cube repository where <code>X.Y.Z</code> is the version of the SDK (for instance <code>C:\Users\JohnDoe\STM32Cube\Repository\MCSDK_v5.0.2\MotorControl</code>). This allows for keeping several versions of the SDK and so to keep on working on application projects developed with different versions of the SDK.</p><p>The version of the SDK used on a given project is that of the Motor Control Workbench used to generate that project. Put in other words, Motor Control Workbench generates projects for the SDK version it is delivered with. </p><p>The version of the SDK to use is not stated in the <code>.stmcx</code> file. It is in the <code>.ioc</code> file generated by the workbench. So, when a project has been generated with a given version of the workbench is sticks to it. Unless it is generated again or updated with another version of the Workbench. In that latter case, it is recommended to erase the <code>MCSDK_vX.Y.Z</code> folder from the previous version…</p><h3><a name='header-n1095' class='md-header-anchor '></a><em>V5.0.1 / 08-Mar-2018</em></h3><h4><a name='header-n1096' class='md-header-anchor '></a>Main Changes</h4><ul><li>First release of X-Cube-MCSDK v5.0.</li></ul><h2><a name='header-n1100' class='md-header-anchor '></a>License</h2><p>This software package is licensed by ST under ST license SLA0048, the &quot;License&quot;; You may not use this package except in compliance with the License. You may obtain a copy of the License at:</p><div style="text-align: center"><http: www.st.com="" sla0048=""></http:></div><div style="text-align: center">For a complete documentation on STM32 Microcontrollers, please visit us at [http://www.st.com/STM32](http://www.st.com/internet/mcu/family/141.jsp)</div></div>
</body>
</html>